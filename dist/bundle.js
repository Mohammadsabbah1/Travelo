$(document).ready((function(){const t=[{id:"AMM",text:"Jordan"},{id:"LAX",text:"Los Angeles, United States"},{id:"JFK",text:"New York, usa"},{id:"LHR",text:"London, United Kingdom"},{id:"NRT",text:"Tokyo, Japan"},{id:"CDG",text:"Paris, France"},{id:"DXB",text:"Dubai, United Arab Emirates"},{id:"FRA",text:"Frankfurt, Germany"},{id:"HND",text:"Tokyo, Japan"},{id:"SYD",text:"Sydney, Australia"},{id:"YYZ",text:"Toronto, Canada"},{id:"YVR",text:"Vancouver, Canada"},{id:"YUL",text:"Montreal, Canada"},{id:"YYC",text:"Calgary, Canada"},{id:"YOW",text:"Ottawa, Canada"}];function e(e,a){$(e).on("input",(function(){const e=$(this).val().toLowerCase(),n=t.filter((t=>t.text.toLowerCase().includes(e))).map((t=>`<li class="p-2 cursor-pointer hover:bg-gray-200" data-id="${t.id}">${t.text}</li>`)).join("");$(a).html(n).show()})),$(document).on("click",`${a} li`,(function(){const t=$(this).text(),n=$(this).data("id");$(e).val(`${n} - ${t}`),$(a).hide()}))}console.log("Script loaded"),$('input[name="trip-type"]').on("change",(function(){"round-trip"===$(this).val()?($("#return-date-container").show(),$("#return-date").prop("required",!0)):($("#return-date-container").hide(),$("#return-date").prop("required",!1))})),e("#origin","#origin-suggestions"),e("#destination","#destination-suggestions"),$(document).on("click",(function(t){$(t.target).closest("#origin, #destination, #origin-suggestions, #destination-suggestions").length||$("#origin-suggestions, #destination-suggestions").hide()})),$("#travel-form").on("submit",(async function(t){t.preventDefault();const e=$("#location").val(),a=$("#depart-date").val(),n=$("#return-date").val(),i=$("#origin").val().split(" - ")[0],o=$("#destination").val().split(" - ")[0],r=$('input[name="trip-type"]:checked').val(),s=$("#loading");s.show();try{const t=await fetch("/coordinates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:e})});if(!t.ok)throw new Error("Failed to fetch coordinates");const s=await t.json();console.log("Coordinates:",s);const d=await fetch("/weather",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lat:s.lat,lng:s.lng,date:a})});if(!d.ok)throw new Error("Failed to fetch weather");const l=await d.json();console.log("Weather Response:",l);let c="No weather data available",g="N/A";l&&l.data&&l.data.length>0&&(c=l.data[0].weather.description||c,g=l.data[0].temp||g);const h=await fetch("/image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:e})});if(!h.ok)throw new Error("Failed to fetch image");const p=(await h.json()).imageUrl;console.log("Image URL:",p);const u=await fetch("/flights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:i,destination:o,departDate:a,returnDate:n,tripType:r})});if(!u.ok)throw new Error("Failed to fetch flights");const f=await u.json();console.log("Flights Data:",f);const m=f.data.filter((t=>{const e=t.itineraries[0].segments[0];return e.departure.iataCode===i&&e.arrival.iataCode===o})),v=new Date(a).toISOString().split("T")[0];$("#trip-info").html(`\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Weather</h2>\n          <p>${c}</p>\n          <p>Temperature: ${g}Â°C</p>\n        </div>\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Image</h2>\n          <img src="${p}" alt="${e}" class="w-full rounded-md shadow-md">\n        </div>\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Flights</h2>\n          <div class="space-y-4">\n            ${m.map((t=>{const e=t.itineraries[0].segments[0],a=e.carrierCode,n=t.validatingAirlineCodes[0],i=`https://www.kayak.com/flights/${e.departure.iataCode}-${e.arrival.iataCode}/${v}`,o=`https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/${a}.svg`;return`\n                <div class="p-4 border rounded-md shadow-md">\n                  <div class="flex justify-between items-center">\n                    <div>\n                      <h3 class="text-lg font-semibold">${e.departure.iataCode} to ${e.arrival.iataCode}</h3>\n                      <p class="text-gray-600">${e.departure.at} - ${e.arrival.at}</p>\n                      <p class="text-gray-600">Airline: ${n}</p>\n                      <img src="${o}" alt="${n} logo" class="h-6 mt-1">\n                    </div>\n                    <div class="text-right">\n                      <p class="text-lg font-bold text-indigo-600">$${t.price.total}</p>\n                      <a href="${i}" target="_blank" class="mt-2 bg-green-500 text-white py-1 px-2 rounded-md">Book</a>\n                    </div>\n                  </div>\n                </div>\n              `})).join("")}\n          </div>\n        </div>\n      `)}catch(t){console.error("Error:",t)}finally{s.hide()}}))}));