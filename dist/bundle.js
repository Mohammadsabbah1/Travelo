$(document).ready((function(){const t=[{id:"AMM",text:"Jordan"},{id:"LAX",text:"Los Angeles, United States"},{id:"JFK",text:"New York, United States"},{id:"LHR",text:"London, United Kingdom"},{id:"NRT",text:"Tokyo, Japan"},{id:"CDG",text:"Paris, France"},{id:"DXB",text:"Dubai, United Arab Emirates"},{id:"FRA",text:"Frankfurt, Germany"},{id:"HND",text:"Tokyo, Japan"},{id:"SYD",text:"Sydney, Australia"}];function e(e,n){$(e).on("input",(function(){const e=$(this).val().toLowerCase(),i=t.filter((t=>t.text.toLowerCase().includes(e))).map((t=>`<li class="p-2 cursor-pointer hover:bg-gray-200" data-id="${t.id}">${t.text}</li>`)).join("");$(n).html(i).show()})),$(document).on("click",`${n} li`,(function(){const t=$(this).text(),i=$(this).data("id");$(e).val(`${i} - ${t}`),$(n).hide()}))}$('input[name="trip-type"]').on("change",(function(){"round-trip"===$(this).val()?($("#return-date-container").show(),$("#return-date").prop("required",!0)):($("#return-date-container").hide(),$("#return-date").prop("required",!1))})),e("#origin","#origin-suggestions"),e("#destination","#destination-suggestions"),$(document).on("click",(function(t){$(t.target).closest("#origin, #destination, #origin-suggestions, #destination-suggestions").length||$("#origin-suggestions, #destination-suggestions").hide()})),$("#travel-form").on("submit",(async function(t){t.preventDefault();const e=$("#location").val(),n=$("#depart-date").val(),i=$("#return-date").val(),a=$("#origin").val().split(" - ")[0],o=$("#destination").val().split(" - ")[0],s=$('input[name="trip-type"]:checked').val(),r=$("#loading");r.show();try{const t=await fetch("/coordinates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:e})});if(!t.ok)throw new Error("Failed to fetch coordinates");const r=await t.json();console.log("Coordinates:",r);const d=await fetch("/weather",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lat:r.lat,lng:r.lng,date:n})});if(!d.ok)throw new Error("Failed to fetch weather");const l=await d.json();console.log("Weather Response:",l);const c=l.data[0]?.weather?.description||"No weather data available",g=await fetch("/image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:e})});if(!g.ok)throw new Error("Failed to fetch image");const h=(await g.json()).imageUrl;console.log("Image URL:",h);const p=await fetch("/flights",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:a,destination:o,departDate:n,returnDate:i,tripType:s})});if(!p.ok)throw new Error("Failed to fetch flights");const u=await p.json();console.log("Flights Data:",u);const f=u.data.filter((t=>{const e=t.itineraries[0].segments[0];return e.departure.iataCode===a&&e.arrival.iataCode===o})),m=new Date(n).toISOString().split("T")[0];$("#trip-info").html(`\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Weather</h2>\n          <p>${c}</p>\n        </div>\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Image</h2>\n          <img src="${h}" alt="${e}" class="w-full rounded-md shadow-md">\n        </div>\n        <div class="mb-4">\n          <h2 class="text-xl font-bold text-gray-800">Flights</h2>\n          <div class="space-y-4">\n            ${f.map((t=>{const e=t.itineraries[0].segments[0],n=e.carrierCode,i=t.validatingAirlineCodes[0],a=`https://www.kayak.com/flights/${e.departure.iataCode}-${e.arrival.iataCode}/${m}`,o=`https://assets.duffel.com/img/airlines/for-light-background/full-color-logo/${n}.svg`;return`\n                <div class="p-4 border rounded-md shadow-md">\n                  <div class="flex justify-between items-center">\n                    <div>\n                      <h3 class="text-lg font-semibold">${e.departure.iataCode} to ${e.arrival.iataCode}</h3>\n                      <p class="text-gray-600">${e.departure.at} - ${e.arrival.at}</p>\n                      <p class="text-gray-600">Airline: ${i}</p>\n                      <img src="${o}" alt="${i} logo" class="h-6 mt-1">\n                    </div>\n                    <div class="text-right">\n                      <p class="text-lg font-bold text-indigo-600">$${t.price.total}</p>\n                      <a href="${a}" target="_blank" class="mt-2 bg-green-500 text-white py-1 px-2 rounded-md">Book</a>\n                    </div>\n                  </div>\n                </div>\n              `})).join("")}\n          </div>\n        </div>\n      `)}catch(t){console.error("Error:",t)}finally{r.hide()}}))}));